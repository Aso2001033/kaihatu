```uml
@startuml
opt アカウントを持っていない
ユーザー -> webサーバー : アカウント登録処理(必要な情報を入力してもらう)
webサーバー -> DBサーバー: アカウント情報登録処理
DBサーバー --> DBサーバー : アカウント情報登録処理
DBサーバー --> webサーバー: 処理結果表示
webサーバー -> ユーザー :処理結果表示
end
ユーザー -> webサーバー : ログイン処理(パスワードとユーザーidを入力してもらう)
webサーバー -> DBサーバー: ログイン処理
DBサーバー --> DBサーバー : ログイン処理
DBサーバー --> webサーバー: 結果表示
webサーバー -> ユーザー :結果表示
loop 購入する商品が決まるまで

alt 商品を検索してカートに入れる場合
ユーザー -> webサーバー : 買いたいものを検索
webサーバー -> DBサーバー: 検索処理
DBサーバー --> DBサーバー : 検索処理
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果
ユーザー -> webサーバー : 詳細表示
webサーバー -> DBサーバー: 詳細検索
DBサーバー --> DBサーバー : 詳細検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果
ユーザー -> webサーバー : カートに入れるボタンを押す
webサーバー -> DBサーバー: カートに商品を追加する
DBサーバー --> DBサーバー : カートに商品を追加する

else 一覧ページからカートに入れる場合
ユーザー -> webサーバー : 詳細表示
webサーバー -> DBサーバー: 詳細検索
DBサーバー --> DBサーバー : 詳細検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果
ユーザー -> webサーバー : カートに入れるボタンを押す
webサーバー -> DBサーバー: カートに商品を追加する
DBサーバー --> DBサーバー : カートに商品を追加する

else カートの中の商品を表示する
ユーザー -> webサーバー : カートのボタンを押す
webサーバー -> DBサーバー: カートの中身を検索
DBサーバー --> DBサーバー : カートの中身を検索
DBサーバー --> webサーバー: 検索結果
loop カート内の商品の個数回
webサーバー -> webサーバー :商品の値段を合計金額に足し、カート内の次の商品を読みこむ
end
webサーバー -> ユーザー :検索結果,合計金額表示

else 購入履歴からカートに入れる場合
ユーザー -> webサーバー : 交流履歴をクリック
webサーバー -> DBサーバー: 購入履歴検索
DBサーバー --> DBサーバー : 購入履歴検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果表示
ユーザー -> webサーバー : 詳細表示
webサーバー -> DBサーバー: 詳細検索
DBサーバー --> DBサーバー : 詳細検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果
ユーザー -> webサーバー : カートに入れるボタンを押す
webサーバー -> DBサーバー: カートに商品を追加する
DBサーバー --> DBサーバー : カートに商品を追加する


opt カートの中身を削除したい場合
ユーザー -> webサーバー : 削除ボタンを押す
webサーバー -> DBサーバー: カートから削除する処理
DBサーバー --> DBサーバー : カートから削除する処理
DBサーバー --> DBサーバー : 削除後のカートの中を検索
DBサーバー --> webサーバー: 検索結果
loop カート内の商品の個数回
webサーバー -> webサーバー :商品の値段を合計金額に足し、カート内の次の商品を読みこむ
end
webサーバー -> ユーザー :検索結果
end
end

end
@enduml
```
