```uml
@startuml
loop 購入する商品が決まるまで

opt 商品をカートに追加する場合

alt 商品を検索してカートに入れる場合
ユーザー -> webサーバー : 買いたいものを検索
webサーバー -> DBサーバー: 検索処理
DBサーバー --> DBサーバー : 検索処理
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果

else 一覧ページからカートに入れる場合
ユーザー -> webサーバー : 一覧表示処理
webサーバー -> DBサーバー: 一覧検索
DBサーバー --> DBサーバー : 一覧検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果

else カテゴリ別ページからカートに入れる場合
ユーザー -> webサーバー : カテゴリ別表示処理
webサーバー -> DBサーバー: 該当カテゴリ商品検索
DBサーバー --> DBサーバー : 該当カテゴリ商品検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果

else 購入履歴からカートに入れる場合
ユーザー -> webサーバー : 購入履歴をクリック
webサーバー -> DBサーバー: 購入履歴検索
DBサーバー --> DBサーバー : 購入履歴検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果表示

else お気に入りからカートに入れる場合
ユーザー -> webサーバー : お気に入りをクリック
webサーバー -> DBサーバー: お気に入り検索
DBサーバー --> DBサーバー : お気に入り検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果表示
end


ユーザー -> webサーバー : 詳細表示
webサーバー -> DBサーバー: 詳細検索
DBサーバー --> DBサーバー : 詳細検索
DBサーバー --> webサーバー: 検索結果
webサーバー -> ユーザー :検索結果
opt お気に入りに追加する場合
ユーザー -> webサーバー : お気に入りボタンを押す
webサーバー -> DBサーバー: お気に入りに商品を追加する
DBサーバー --> DBサーバー : お気に入りに商品を追加する
end
ユーザー -> webサーバー : カートに入れるボタンを押す
webサーバー -> DBサーバー: カートに商品を追加する
DBサーバー --> DBサーバー : カートに商品を追加する

end

opt カートの中の商品を表示する
ユーザー -> webサーバー : カートのボタンを押す
webサーバー -> DBサーバー: カートの中身を検索
DBサーバー --> DBサーバー : カートの中身を検索
DBサーバー --> webサーバー: 検索結果
loop カート内の商品の個数回
webサーバー -> webサーバー :商品の値段を合計金額に足し、カート内の次の商品を読みこむ
end
webサーバー -> ユーザー :検索結果,合計金額表示
end

opt カートの中身を削除したい場合
ユーザー -> webサーバー : 削除ボタンを押す
webサーバー -> DBサーバー: カートから削除する処理
DBサーバー --> DBサーバー : カートから削除する処理
DBサーバー --> DBサーバー : 削除後のカートの中を検索
DBサーバー --> webサーバー: 検索結果
loop カート内の商品の個数回
webサーバー -> webサーバー :商品の値段を合計金額に足し、カート内の次の商品を読みこむ
end
webサーバー -> ユーザー :検索結果
end
end

@enduml
```
